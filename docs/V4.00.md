## ğŸš€ iPhoto v4.00 â€” MVVM Architecture & Advanced Editing
ğŸ“¸ *MVVM architecture for smooth performance, color curves support, and cluster-based map browsing.*

We're excited to announce **iPhoto v4.00**! ğŸ‰  
This major update brings a complete architectural transformation with **MVVM design pattern**, significantly reducing lag and improving system responsiveness. We've also added powerful **color curve adjustments** and **cluster-based map navigation** for a better photo management experience.

---

### ğŸŒŸ Key Updates in v4.00

#### ğŸ—ï¸ **MVVM Architecture â€” Dramatically Improved Performance**
*Addressing user feedback: "Reduced lag and improved responsiveness"*

- **Complete Architectural Refactoring:** We have transformed the codebase to follow the **Model-View-ViewModel (MVVM)** design pattern.
- **Separation of Concerns:** Clear separation between UI presentation, business logic, and data management layers.
- **Reactive UI Updates:** The ViewModel efficiently manages state changes and automatically updates the View, eliminating unnecessary re-renders.
- **Reduced Operation Lag:** Significantly lower UI freezing and lag during photo browsing, editing, and library management operations.
- **Enhanced System Fluency:** Smooth scrolling, instant thumbnail loading, and responsive interactions even with large photo libraries.
- **Better Resource Management:** Improved memory usage and CPU efficiency through proper data binding and lifecycle management.

#### ğŸ¨ **Color Curves Support**
Professional-grade color grading with full curve control:

- **Comprehensive Curve Editor:**  
  - RGB Master curve for overall tonal adjustments
  - Individual Red, Green, and Blue channel curves for precise color grading
  - Interactive curve editor with draggable control points
  - Real-time preview of adjustments

- **Professional Color Grading:**  
  - Cinematic color looks and film emulation
  - Selective color adjustments without affecting other tones
  - Shadow, midtone, and highlight control with infinite precision
  - Support for both subtle corrections and creative color grading

- **Advanced Curve Controls:**  
  - Add and remove control points anywhere on the curve
  - Smooth Bezier interpolation for natural transitions
  - Histogram overlay for precise tone mapping
  - Reset and preset curve profiles for quick adjustments

- **Non-Destructive Workflow:**  
  - All curve adjustments saved in `.ipo` sidecar files
  - Full editability â€” modify or remove curves at any time
  - Original photos remain completely untouched

#### ğŸ—ºï¸ **Cluster-Based Map Browsing**
Enhanced map view with intelligent photo clustering:

- **Smart Clustering:**  
  - Automatically groups nearby photos into clusters based on GPS coordinates
  - Dynamic cluster sizing adapts to zoom level and photo density
  - Visual cluster indicators show the number of photos in each location

- **Improved Navigation:**  
  - Zoom and pan to explore photo locations efficiently
  - Click on clusters to expand and view individual photos
  - Smooth transitions when navigating between clusters

- **Better Performance:**  
  - Efficient rendering of thousands of GPS-tagged photos
  - Fast map interactions even with massive photo libraries
  - Reduced memory usage through intelligent cluster management

- **Enhanced User Experience:**  
  - Clear visualization of photo distribution across locations
  - Easier discovery of photos taken in specific geographic areas
  - Intuitive interaction with grouped photos on the map

---

### ğŸ¯ Core Features (Carried Forward)

All beloved features from previous versions remain fully supported:

- **ğŸ¥ Full Live Photo Support**  
  Automatically pairs HEIC/JPG + MOV files by content-ID or timestamp, with a "LIVE" badge and inline playback.

- **ğŸ—‚ Folder = Album**  
  Each folder becomes an album, managed by `.iphoto.album.json` (or `.iphoto.album`).

- **ğŸ§  Smart Albums**  
  Built-in "Library", "All Photos", "Videos", "Favorites", and "Recently Deleted" views.

- **ğŸ–¼ Immersive Detail Viewer**  
  Elegant photo/video viewer with filmstrip navigation and floating playback controls.

- **ğŸ¨ Non-Destructive Photo Editing**  
  Comprehensive editing suite with Adjust and Crop modes (v2.00 features).

- **âš¡ SQLite Global Database**  
  Enterprise-grade performance for TB-level photo libraries (v3.00 architecture).

---

### ğŸ”§ Technical Highlights

#### **MVVM Architecture Benefits**
```
View Layer (UI Components)
    â†“ (Data Binding)
ViewModel Layer (State Management & Business Logic)
    â†“ (Data Access)
Model Layer (SQLite Database & File System)
```

**Key Advantages:**
- **Reactive Updates:** UI automatically reflects data changes without manual refresh
- **Testability:** Business logic separated from UI for easier unit testing
- **Maintainability:** Clear separation of concerns makes code easier to maintain and extend
- **Performance:** Efficient state management reduces unnecessary computations and re-renders

#### **Color Curves Implementation**
- GPU-accelerated curve evaluation using lookup tables (LUTs)
- Real-time preview with hardware-accelerated rendering
- Bezier curve interpolation for smooth tonal transitions
- Support for linear and logarithmic curve spaces

#### **Map Clustering Algorithm**
- K-means clustering with dynamic K based on zoom level
- Geo-spatial indexing for fast cluster computation
- Progressive loading for large datasets
- Adaptive cluster boundaries based on viewport

---

## ğŸ‡¨ğŸ‡³ iPhoto v4.00 â€” MVVM æ¶æ„ä¸é«˜çº§ç¼–è¾‘

ğŸ“¸ *MVVM æ¶æ„å¸¦æ¥æµç•…æ€§èƒ½ï¼Œæ”¯æŒè°ƒè‰²æ›²çº¿ï¼Œåœ°å›¾æŒ‰èšç±»æµè§ˆã€‚*

æˆ‘ä»¬éå¸¸æ¿€åŠ¨åœ°å®£å¸ƒ **iPhoto v4.00** æ­£å¼å‘å¸ƒï¼ğŸ‰  
è¿™ä¸ªé‡å¤§æ›´æ–°å¸¦æ¥äº†å®Œæ•´çš„ **MVVM è®¾è®¡æ¨¡å¼**æ¶æ„è½¬å‹ï¼Œå¤§å¹…é™ä½æ“ä½œå¡é¡¿æ„Ÿï¼Œæé«˜ç³»ç»Ÿæµç•…åº¦ã€‚æˆ‘ä»¬è¿˜å¢åŠ äº†å¼ºå¤§çš„ **è°ƒè‰²æ›²çº¿è°ƒæ•´** åŠŸèƒ½å’Œ **åŸºäºèšç±»çš„åœ°å›¾å¯¼èˆª**ï¼Œå¸¦æ¥æ›´å¥½çš„ç…§ç‰‡ç®¡ç†ä½“éªŒã€‚

---

### ğŸŒŸ v4.00 ä¸»è¦æ›´æ–°

#### ğŸ—ï¸ **MVVM æ¶æ„ â€” æ€§èƒ½å¤§å¹…æå‡**
*å›åº”ç”¨æˆ·åé¦ˆï¼šé™ä½å¡é¡¿ï¼Œæå‡å“åº”é€Ÿåº¦*

- **å®Œæ•´çš„æ¶æ„é‡æ„ï¼š** æˆ‘ä»¬å°†ä»£ç åº“è½¬æ¢ä¸ºéµå¾ª **Model-View-ViewModel (MVVM)** è®¾è®¡æ¨¡å¼ã€‚
- **å…³æ³¨ç‚¹åˆ†ç¦»ï¼š** UI å‘ˆç°å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®ç®¡ç†å±‚ä¹‹é—´çš„æ¸…æ™°åˆ†ç¦»ã€‚
- **å“åº”å¼ UI æ›´æ–°ï¼š** ViewModel é«˜æ•ˆç®¡ç†çŠ¶æ€å˜åŒ–å¹¶è‡ªåŠ¨æ›´æ–°è§†å›¾ï¼Œæ¶ˆé™¤ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚
- **é™ä½æ“ä½œå»¶è¿Ÿï¼š** åœ¨ç…§ç‰‡æµè§ˆã€ç¼–è¾‘å’Œå›¾åº“ç®¡ç†æ“ä½œæœŸé—´ï¼Œæ˜¾è‘—å‡å°‘ UI å†»ç»“å’Œå¡é¡¿ã€‚
- **å¢å¼ºç³»ç»Ÿæµç•…åº¦ï¼š** å³ä½¿åœ¨å¤§å‹ç…§ç‰‡åº“ä¸­ï¼Œä¹Ÿèƒ½å®ç°æµç•…æ»šåŠ¨ã€å³æ—¶ç¼©ç•¥å›¾åŠ è½½å’Œå“åº”å¼äº¤äº’ã€‚
- **æ›´å¥½çš„èµ„æºç®¡ç†ï¼š** é€šè¿‡é€‚å½“çš„æ•°æ®ç»‘å®šå’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ”¹å–„å†…å­˜ä½¿ç”¨å’Œ CPU æ•ˆç‡ã€‚

#### ğŸ¨ **è°ƒè‰²æ›²çº¿æ”¯æŒ**
ä¸“ä¸šçº§è‰²å½©åˆ†çº§ï¼Œå®Œå…¨æ›²çº¿æ§åˆ¶ï¼š

- **å…¨é¢çš„æ›²çº¿ç¼–è¾‘å™¨ï¼š**  
  - RGB ä¸»æ›²çº¿ç”¨äºæ•´ä½“è‰²è°ƒè°ƒæ•´
  - ç‹¬ç«‹çš„çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²é€šé“æ›²çº¿ï¼Œç”¨äºç²¾ç¡®çš„è‰²å½©åˆ†çº§
  - å¸¦æœ‰å¯æ‹–åŠ¨æ§åˆ¶ç‚¹çš„äº¤äº’å¼æ›²çº¿ç¼–è¾‘å™¨
  - å®æ—¶é¢„è§ˆè°ƒæ•´æ•ˆæœ

- **ä¸“ä¸šè‰²å½©åˆ†çº§ï¼š**  
  - ç”µå½±çº§è‰²å½©å¤–è§‚å’Œèƒ¶ç‰‡æ¨¡æ‹Ÿ
  - é€‰æ‹©æ€§è‰²å½©è°ƒæ•´ï¼Œä¸å½±å“å…¶ä»–è‰²è°ƒ
  - å¯¹é˜´å½±ã€ä¸­é—´è°ƒå’Œé«˜å…‰è¿›è¡Œæ— é™ç²¾åº¦æ§åˆ¶
  - æ”¯æŒå¾®å¦™æ ¡æ­£å’Œåˆ›æ„è‰²å½©åˆ†çº§

- **é«˜çº§æ›²çº¿æ§åˆ¶ï¼š**  
  - åœ¨æ›²çº¿ä¸Šçš„ä»»ä½•ä½ç½®æ·»åŠ å’Œåˆ é™¤æ§åˆ¶ç‚¹
  - å¹³æ»‘çš„è´å¡å°”æ’å€¼ï¼Œå®ç°è‡ªç„¶è¿‡æ¸¡
  - ç›´æ–¹å›¾å åŠ ï¼Œå®ç°ç²¾ç¡®çš„è‰²è°ƒæ˜ å°„
  - é‡ç½®å’Œé¢„è®¾æ›²çº¿é…ç½®æ–‡ä»¶ï¼Œå¿«é€Ÿè°ƒæ•´

- **éç ´åæ€§å·¥ä½œæµç¨‹ï¼š**  
  - æ‰€æœ‰æ›²çº¿è°ƒæ•´ä¿å­˜åœ¨ `.ipo` é™„å±æ–‡ä»¶ä¸­
  - å®Œå…¨å¯ç¼–è¾‘ â€” éšæ—¶ä¿®æ”¹æˆ–åˆ é™¤æ›²çº¿
  - åŸå§‹ç…§ç‰‡ä¿æŒå®Œå…¨ä¸å˜

#### ğŸ—ºï¸ **åŸºäºèšç±»çš„åœ°å›¾æµè§ˆ**
å¢å¼ºçš„åœ°å›¾è§†å›¾ï¼Œæ™ºèƒ½ç…§ç‰‡èšç±»ï¼š

- **æ™ºèƒ½èšç±»ï¼š**  
  - æ ¹æ® GPS åæ ‡è‡ªåŠ¨å°†é™„è¿‘çš„ç…§ç‰‡åˆ†ç»„ä¸ºèšç±»
  - åŠ¨æ€èšç±»å¤§å°æ ¹æ®ç¼©æ”¾çº§åˆ«å’Œç…§ç‰‡å¯†åº¦è‡ªé€‚åº”
  - å¯è§†åŒ–èšç±»æŒ‡ç¤ºå™¨æ˜¾ç¤ºæ¯ä¸ªä½ç½®çš„ç…§ç‰‡æ•°é‡

- **æ”¹è¿›çš„å¯¼èˆªï¼š**  
  - ç¼©æ”¾å’Œå¹³ç§»ä»¥é«˜æ•ˆæ¢ç´¢ç…§ç‰‡ä½ç½®
  - ç‚¹å‡»èšç±»ä»¥å±•å¼€å¹¶æŸ¥çœ‹å•ä¸ªç…§ç‰‡
  - åœ¨èšç±»ä¹‹é—´å¯¼èˆªæ—¶å¹³æ»‘è¿‡æ¸¡

- **æ›´å¥½çš„æ€§èƒ½ï¼š**  
  - é«˜æ•ˆæ¸²æŸ“æ•°åƒå¼ å¸¦æœ‰ GPS æ ‡è®°çš„ç…§ç‰‡
  - å³ä½¿åœ¨è¶…å¤§ç…§ç‰‡åº“ä¸­ä¹Ÿèƒ½å®ç°å¿«é€Ÿåœ°å›¾äº¤äº’
  - é€šè¿‡æ™ºèƒ½èšç±»ç®¡ç†å‡å°‘å†…å­˜ä½¿ç”¨

- **å¢å¼ºçš„ç”¨æˆ·ä½“éªŒï¼š**  
  - æ¸…æ™°å¯è§†åŒ–ç…§ç‰‡åœ¨å„ä½ç½®çš„åˆ†å¸ƒ
  - æ›´å®¹æ˜“å‘ç°åœ¨ç‰¹å®šåœ°ç†åŒºåŸŸæ‹æ‘„çš„ç…§ç‰‡
  - ä¸åœ°å›¾ä¸Šåˆ†ç»„çš„ç…§ç‰‡ç›´è§‚äº¤äº’

---

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ï¼ˆç»§æ‰¿è‡ªä¹‹å‰ç‰ˆæœ¬ï¼‰

ä¹‹å‰ç‰ˆæœ¬ä¸­çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å‡å¾—åˆ°å®Œæ•´ä¿ç•™ï¼š

- **ğŸ¥ å®Œæ•´çš„ Live Photo æ”¯æŒ**ï¼šè‡ªåŠ¨é…å¯¹ HEIC/JPG ä¸ MOV æ–‡ä»¶ï¼Œé™æ€ç…§ç‰‡å¸¦ "LIVE" å¾½ç« ï¼Œå¯ç›´æ¥æ’­æ”¾åŠ¨æ€è§†é¢‘ã€‚
- **ğŸ—‚ æ–‡ä»¶å¤¹å³ç›¸å†Œ**ï¼šæ¯ä¸ªæ–‡ä»¶å¤¹å‡è§†ä¸ºç›¸å†Œï¼Œé€šè¿‡ `.iphoto.album.json` ç®¡ç†å°é¢ã€ç²¾é€‰ä¸æ’åºã€‚
- **ğŸ§  æ™ºèƒ½ç›¸å†Œ**ï¼šå†…ç½® "å›¾åº“"ã€"æ‰€æœ‰ç…§ç‰‡"ã€"è§†é¢‘"ã€"æ”¶è—"ã€"æœ€è¿‘åˆ é™¤" ç­‰è‡ªåŠ¨èšåˆè§†å›¾ã€‚
- **ğŸ–¼ æ²‰æµ¸å¼æŸ¥çœ‹å™¨**ï¼šå¸¦èƒ¶ç‰‡æ¡ä¸æµ®åŠ¨æ’­æ”¾æ§ä»¶çš„ç…§ç‰‡/è§†é¢‘æŸ¥çœ‹ä½“éªŒã€‚
- **ğŸ¨ éç ´åæ€§ç…§ç‰‡ç¼–è¾‘**ï¼šåŒ…å«è°ƒæ•´å’Œè£å‰ªæ¨¡å¼çš„å…¨é¢ç¼–è¾‘å¥—ä»¶ï¼ˆv2.00 åŠŸèƒ½ï¼‰ã€‚
- **âš¡ SQLite å…¨å±€æ•°æ®åº“**ï¼šä¸º TB çº§åˆ«ç…§ç‰‡åº“æä¾›ä¼ä¸šçº§æ€§èƒ½ï¼ˆv3.00 æ¶æ„ï¼‰ã€‚

---

### ğŸ”§ æŠ€æœ¯äº®ç‚¹

#### **MVVM æ¶æ„ä¼˜åŠ¿**
```
è§†å›¾å±‚ï¼ˆUI ç»„ä»¶ï¼‰
    â†“ï¼ˆæ•°æ®ç»‘å®šï¼‰
è§†å›¾æ¨¡å‹å±‚ï¼ˆçŠ¶æ€ç®¡ç†ä¸ä¸šåŠ¡é€»è¾‘ï¼‰
    â†“ï¼ˆæ•°æ®è®¿é—®ï¼‰
æ¨¡å‹å±‚ï¼ˆSQLite æ•°æ®åº“ä¸æ–‡ä»¶ç³»ç»Ÿï¼‰
```

**ä¸»è¦ä¼˜åŠ¿ï¼š**
- **å“åº”å¼æ›´æ–°ï¼š** UI è‡ªåŠ¨åæ˜ æ•°æ®å˜åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°
- **å¯æµ‹è¯•æ€§ï¼š** ä¸šåŠ¡é€»è¾‘ä¸ UI åˆ†ç¦»ï¼Œæ›´æ˜“äºå•å…ƒæµ‹è¯•
- **å¯ç»´æŠ¤æ€§ï¼š** å…³æ³¨ç‚¹çš„æ¸…æ™°åˆ†ç¦»ä½¿ä»£ç æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•
- **æ€§èƒ½ï¼š** é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†å‡å°‘ä¸å¿…è¦çš„è®¡ç®—å’Œé‡æ–°æ¸²æŸ“

#### **è°ƒè‰²æ›²çº¿å®ç°**
- ä½¿ç”¨æŸ¥æ‰¾è¡¨ï¼ˆLUTï¼‰è¿›è¡Œ GPU åŠ é€Ÿçš„æ›²çº¿è¯„ä¼°
- ç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“çš„å®æ—¶é¢„è§ˆ
- è´å¡å°”æ›²çº¿æ’å€¼ï¼Œå®ç°å¹³æ»‘çš„è‰²è°ƒè¿‡æ¸¡
- æ”¯æŒçº¿æ€§å’Œå¯¹æ•°æ›²çº¿ç©ºé—´

#### **åœ°å›¾èšç±»ç®—æ³•**
- åŸºäºç¼©æ”¾çº§åˆ«çš„åŠ¨æ€ K å€¼çš„ K-means èšç±»
- ç”¨äºå¿«é€Ÿèšç±»è®¡ç®—çš„åœ°ç†ç©ºé—´ç´¢å¼•
- å¤§å‹æ•°æ®é›†çš„æ¸è¿›å¼åŠ è½½
- åŸºäºè§†å£çš„è‡ªé€‚åº”èšç±»è¾¹ç•Œ

---

### ğŸ“Š Version Comparison / ç‰ˆæœ¬å¯¹æ¯”

| Feature / åŠŸèƒ½ | v3.00 | v4.00 |
|----------------|--------|--------|
| SQLite global database / SQLite å…¨å±€æ•°æ®åº“ | âœ… | âœ… |
| Non-destructive editing / éç ´åæ€§ç¼–è¾‘ | âœ… | âœ… |
| Map view / åœ°å›¾è§†å›¾ | âœ… | âœ… |
| Live Photo support / Live Photo æ”¯æŒ | âœ… | âœ… |
| **MVVM Architecture / MVVM æ¶æ„** | âŒ | âœ… |
| **Color Curves / è°ƒè‰²æ›²çº¿** | âŒ | âœ… |
| **Map Clustering / åœ°å›¾èšç±»** | âŒ | âœ… |
| **Enhanced Performance / å¢å¼ºæ€§èƒ½** | âœ… | âœ…âœ… |
| **Reduced Lag / é™ä½å¡é¡¿** | âœ… | âœ…âœ… |

---

### ğŸ’¬ Feedback / åé¦ˆä¸å»ºè®®

We'd love to hear from you!  
If you encounter any issues or have ideas for improvement, please open a ticket on [GitHub Issues](https://github.com/OliverZhaohaibin/iPhotron-LocalPhotoAlbumManager/issues).  
Your feedback helps shape the future of **iPhoto**. ğŸ’™  
Thank you for your support!

æˆ‘ä»¬éå¸¸æœŸå¾…æ‚¨çš„åé¦ˆï¼  
å¦‚æœæ‚¨åœ¨ä½¿ç”¨ä¸­å‘ç°é—®é¢˜ï¼Œæˆ–æœ‰æ–°çš„åŠŸèƒ½å»ºè®®ï¼Œæ¬¢è¿å‰å¾€ [GitHub Issues](https://github.com/OliverZhaohaibin/iPhotron-LocalPhotoAlbumManager/issues) æäº¤ã€‚  
æ¯ä¸€æ¡æ„è§éƒ½å°†å¸®åŠ©æˆ‘ä»¬è®© **iPhoto** å˜å¾—æ›´å¥½ã€‚ğŸ’™  
æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼

---

**iPhoto v4.00** â€” *Smooth as silk. Powerful as ever.*  
**iPhoto v4.00** â€” *æµç•…å¦‚ä¸ï¼Œå¼ºå¤§å¦‚åˆã€‚*
